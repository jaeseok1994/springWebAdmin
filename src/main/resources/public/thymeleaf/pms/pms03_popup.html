<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>주간업무보고 등록</title>
    <div th:replace="headerRGrid"></div>
</head>
<style>
/* 테이블 셀 높이*/
.ACell {width:40px;height:10px;background:#BDBDBD;}
.BCell {width:100px;height:50px;font-size:15px;}
.CCell {width:100px;height:10px;background:#BDBDBD;}
.textarea { height:400px; width:98%; !important; }
</style>
<script>
     var app;


     var today = new Date();
     var setToday = today.getFullYear()+'-'+('0'+(today.getMonth()+1)).slice(-2)+'-'+today.getDate();
    $(document.body).ready(function(){
        app = new Vue({
            el:'#form',
            data:{
                projList:[],
                keys:{
                    affr_no: '',
                    proj_no: '',
                    title: '',
                    writer: 'admin',
                    wr_dt: setToday,
                    st_dt: setToday,
                    fn_dt: setToday,
                    twk_ars: '',
                    nxw_pln: '',
                    twk_pln_rate: '',
                    twk_ars_rate: '',
                    acum_pln_rate: '',
                    acum_ars_rate: '',
                    rem: '',
                },
                methods:{
                }
            },
        });
        $("#goSave").click(function(){
             if(app.keys.affr_no == ""){
                console.log("affr_no is Null");
                console.log("console:"+app.keys.affr_no);
               maintList('insert');
             }else{
                console.log("affr_no is Not Null");
                console.log("affr_no:::"+app.keys.affr_no);
             //maintList('update');
             }
        });

    });

    function maintList(func,key){

        var searchParam = {};
        searchParam.func = func;

        var jsonData = {
                  map: app.keys,
            };
            fn_transaction(func,"/service/pms/pms03_popup/maintList2.do/"+func+"List",jsonData,fn_callback);
            return;

    }
    function fn_callback(func,data,status){
        if(data.error){
            alert(data.error);
        }else{
             if(func == "maint"){
                fn_alert('정상적으로 저장되었습니다.');
                close();
            }else if(func == "code"){
                setCode(data.resultList);
            }else{
                fn_alert(data.message);
                close();
            }
        }
    }
    function getCode(){
    	fn_transaction("code","/service/pms/pms03_popup/selectList.do/codeList",{},fn_callback);
    }
     function setCode(resultList) {
        var str = '<option value="">선택</option>';
        $.each(resultList,function(k,v){
            str += '<option value="'+v.code+'">'+v.name+'</option>';
        });
        $('#proj_no').html(str);
    }
</script>
<body>
<div id="form" class="contentPgm">
    <div class="content_title">주간업무보고 등록</div>
    <div class="box_Atype">
        <table class="tbl_base">
            <caption>주간업무보고 등록</caption>
            <colgroup>
                <col style="width:100px;"/>
                <col style="width:150px;"/>
                <col style="width:100px;"/>
                <col style="width:150px;"/>

            </colgroup>
            <tbody>
            <tr>
                <td class="ar">프로젝트 명</td>
                <td>
                    <!--<select name="proj_no" id="proj_no" class="ui_sel w80p" v-model="keys.proj_no">
                        <option value="">선택</option>
                        <option v-for="list in projList" :value="list.value">{{list.text}}</option>
                    </select>-->
                    <select name="proj_no" id="proj_no" class="ui_sel w100p" v-model="keys.proj_no"></select>
                </td>
                <td class="ar">제목</td>
                <td>
                    <input id="title" type="text" class="input_A w70p" v-model="keys.title">
                </td>
                <td class="ar">기안날짜</td>
                <td>
                    <datepicker id="wr_dt" class="input_A w60p" v-model="keys.wr_dt"></datepicker>
                </td>
                <td class="ar">기간</td>
                <td>
                    <datepicker id="st_dt" class="input_A w40p" v-model="keys.st_dt"></datepicker>~
                    <datepicker id="fn_dt" class="input_A w40p" v-model="keys.fn_dt"></datepicker>
                </td>
                <td class="ar">작성자</td>
                <td>
                    <input id="writer" type="text" class="input_A w60p" v-model="keys.writer" readonly>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <div class="gap5"></div>

    <div class="ar">
        <!--<div id="goSelect" class="btn_typeA btn_search">조회</div>
        <div id="goAdd" class="btn_typeA btn_save">추가</div>
        <div id="goDelete" class="btn_typeA btn_delete">삭제</div>
        <div id="goExcel" class="btn_typeA btn_excel">Excel</div>-->
        <div id="goSave" class="btn_typeA btn_save">저장</div>
        <div id="popClose" class="btn_typeA btn_close">Close</div>
    </div>
    <div class="content_title">주간업무</div>
        <div class="box_Atype">
            <table class="tbl_base" border="1">
                <tr>
                    <th colspan="8" style="height:40px;background-color:#BDBDBD;">금주실적</th>
                    <th colspan="2" style="height:40px;background-color:#BDBDBD;">차주계획</th>
                </tr>
                <tr>
                    <td colspan="8" style="padding:5px;">
                        <!--<input id="data1" type="text" class="input_TE w100p">-->
                        <!--<textarea id="acdnSbc" v-model="key.twk_ars" rows="30" cols="100" style="width:99%;height:400px;font-size:18px; resize: none;" ></textarea>-->
                        <textarea id="twk_ars" type="text" class="textarea" v-model.trim="keys.twk_ars" style="resize: none;" ></textarea>
                    </td>

                    <td colspan="2" style="padding:5px;">
                        <!--<textarea id="acdnSbc" v-model="key.nxw_pln" rows="30" cols="100" style="width:99%;height:400px;font-size:18px; resize: none;" ></textarea>-->
                        <textarea id="nxw_pln" type="text" class="textarea" v-model.trim="keys.nxw_pln" style="resize: none;"></textarea>
                    </td>
                </tr>
                <tr>
                    <th class="CCell" colspan="8">진척률</th>
                    <th class="ACell" rowspan="3">비고</th><td rowspan="3" width="800px"><textarea id="rem" type="text" v-model.trim="keys.rem" style="width:98%;height:110px;font-size:15px; resize: none;"></textarea></td>
                </tr>
                <tr>
                    <th class="CCell">금주계획</th><td><input id="twk_pln_rate" type="text" class="input_A BCell" v-model="keys.twk_pln_rate"></td>
                    <th class="CCell">금주실적</th><td><input id="twk_ars_rate" type="text" class="input_A BCell" v-model="keys.twk_ars_rate"></td>
                    <th class="CCell">누적계획</th><td><input id="acum_pln_rate" type="text" class="input_A BCell" v-model="keys.acum_pln_rate"></td>
                    <th class="CCell">누적실적</th><td><input id="acum_ars_rate" type="text" class="input_A BCell" v-model="keys.acum_ars_rate"></td>
                </tr>
                <tr>
                    <th class="ACell">첨부파일</th>
                    <td colspan="9">
                        <!--<input type="file" id="file_sn" name="file_sn" multiple v-model="keys.file_sn">-->
                    </td>
                </tr>
            </table>
        </div>
</div>



    <table class="tbl_base" border = "1">


    </table>

<div class="content_title">위험 및 이슈현황</div>
</body>
</html>